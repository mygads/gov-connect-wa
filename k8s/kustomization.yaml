# ==================== KUSTOMIZATION ====================
# Kustomize configuration for easy deployment
# Usage: kubectl apply -k k8s/

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: govconnect

# Common labels for all resources
commonLabels:
  app.kubernetes.io/part-of: govconnect-platform
  app.kubernetes.io/managed-by: kustomize

# Resources to deploy (in order)
resources:
  # Core resources
  - 00-namespace.yaml
  - 01-configmap.yaml
  - 02-secrets.yaml
  # Infrastructure
  - 10-postgres.yaml
  - 11-rabbitmq.yaml
  # Microservices
  - 20-channel-service.yaml
  - 21-ai-service.yaml
  - 22-case-service.yaml
  - 23-notification-service.yaml
  - 24-dashboard.yaml
  # API Gateway (Traefik) - apply separately via Helm
  # See: k8s/api-gateway/deploy-traefik.sh
  # Traefik middleware and IngressRoutes
  - api-gateway/01-middleware.yaml
  - api-gateway/02-ingressroute.yaml

# Images configuration (update for your registry)
images:
  - name: govconnect/channel-service
    newTag: latest
  - name: govconnect/ai-service
    newTag: latest
  - name: govconnect/case-service
    newTag: latest
  - name: govconnect/notification-service
    newTag: latest
  - name: govconnect/dashboard
    newTag: latest
